# -*- coding: utf-8 -*-
"""hw-3-2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1HKONeMV8wBGUaQCzO3cGrpGlwiZyeQxx

Домашнее задание.

Проделать процесс обучения модели линейной регрессии на следующих входных данных:
X = 1, 3, 7
y = 2, 6, 14
Делать можно вручную, как на занятии или на компьютере.
Взять lr = 0.01. Сделать вывод, хорошие получились ли веса и похожи ли они на “настоящие”.
Настоящие веса можно узнать, построив график прямой по данным 3 точкам и сопоставив w с угловым и b со свободным коэффициентом.
"""

import matplotlib.pyplot as plt

# Исходные данные
x = [1, 3, 7]
y = [2, 6, 14]
lr = 0.01 #гиперпараметр


# Инициализация весов
w1 = 0
w0 = 0

for i in range(len(x)):
  prediction = w1 * X[i] + w0 # Прямой проход
  # Вычисление градиентов и обновление весов
  w1 += 2 * lr * x[i] * (y[i] - prediction)
  w0 += 2 * lr * (y[i] - prediction)

# Вывод полученных весов
print(f'Полученные веса: w1 = {w1}, w0 = {w0}')

# Построение графика
plt.scatter(x, y)
plt.plot(x, [w1 * x + w0 for x in x], color='r')
plt.xlabel('X')
plt.ylabel('y')
plt.show()

"""Вывод: Исходя из графика мы можем сделать вывод: Веса выбраны хорошие, потому как прямая проходит близко к точкам."""